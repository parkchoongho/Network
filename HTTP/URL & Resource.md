# URL과 리소스

## 2. URL과 리소스

### 2-1. 인터넷의 리소스 탐색하기

http://www.joes-hardware.com/seasonal/index-fall.html이라는 URL을 불러온다고 가정해봅시다.

- URL 첫 부분인 http는 URL의 스킴이다. 스킴은 웹 클라이언트가 리소스에 어떻게 접근하는지 알려줍니다. 이 경우에, URL이 http 프로토콜을 사용합니다.
- URL의 두 번째 부분 www.joes-hardware.com는 서버의 위치입니다. 이는 웹 클라이언트 리소스가 어디에 호스팅 되어있는지 알려줍니다.
- URL의 세 번째 부분 /seasonal/index-fall.html은 리소스 경로입니다. 경로는 서버에 존재하는 로컬 리소스 중 요청받은 리소스가 무엇인지 알려줍니다.

대부분의 URL은 동일하게 '스킹://서버위치/경로' 구조로 구성되어 있습니다. 모든 사람이 같은 방식으로 이름을 써서 리소스를 찾을 수 있도록, 단일 방식의 작명 규칙을 가지게 된 것입니다.

### 2-2. URL 문법

대부분의URL 스킴 문법은 일반적으로 9가지로 나뉘어 집니다.

**<스킴>://<사용자 이름>:<비밀번호>@<호스트>:<포트>/<경로>;<파라미터>?<질의>#<프래그먼트>**

이 중에 가장 중요한 세가지 컴포넌트는 스킴, 호스트, 경로입니다.

### 2-2-1. 스킴: 사용할 프로토콜

스킴은 주어진 리소스에 어떻게 접근할지에 대해 담고 있는 중요한 정보입니다. 이는 URL을 읽어들이는 애플리케이션이 어떤 프로토콜을 사용하여 리소스를 요청해야 하는지를 알려줍니다. 스킴 컴포넌트는 알파벳으로 시작해야 하고 URL의 나머지 부분들과는 첫 번째 ':' 문자로 구분되어 집니다. 스킴명은 대소문자를 가리지 않습니다.

### 2-2-2. 호스트와 포트

인터넷에 있는 리소스를 찾기 위해서는 리소스를 호스팅하고 있는 장비와 그 장비내 서버가 어디 있는지 알아야 합니다. URL의 호스트와 포트 컴포넌트는 그 두가지 정보를 제공합니다.

www.joes-hardware.com 와 161.58.228.45는 같은 것을 의미합니다. 포트 컴포넌트는 서버가 열어놓은 네트워크 포트를 의미하고 내부적으로 HTTP는 기본포트로 80을 사용합니다.

### 2-2-3. 사용자 이름과 비밀번호

많은 서버가 자신이 가지고 있는 데이터에 접근을 허용하기 전에 사용자 이름과 비밀번호를 요구합니다. FTP 서버가 그에 대한 예시를 보여줍니다.

ftp://ftp.prep.ai..mit.edu/pub/gnu

ftp://anonymous@ftp.prep.ai..mit.edu/pub/gnu

ftp://anonymous:my_passwd@ftp.prep.ai..mit.edu/pub/gnu

첫 번째 예시를 보면 사용자 이름과 비밀번호 없이 스킴과 호스트, 경로만 존재합니다. 애플리케이션이 FTP 같이 사용자 이름과 비밀번호가 필요한 URL 스킴을 사용하는데, 값들이 입력되어 있지 않으면 기본 사용자 이름과 비밀번호를 적용합니다.

### 2-2-4. 경로

URL의 경로 컴포넌트는 리소스가 서버 어디에 존재하는지 알려줍니다. 해당 경로는 밑에 예처럼 계층적 파일 시스템 경로와 유사한 구조를 지닙니다.

http://www.joes-hardware.com:80/seasonal/index-fall.html

경로는 서버가 리소스의 위치를 찾는데 사용하는 정보입니다. HTTP URL에서 경로 컴포넌트는 `'/'` 문자를 기준으로 경로조각으로 나누어집니다. 각 경로조각은 자기만의 파라미터 컴포넌트를 가질 수 있습니다.

### 2-2-5. 파라미터

많은 스킴이 호스트 및 경로 정보만으로 리소스를 찾지 못합니다. 포트 번호, 사용자 이름, 비밀번호 외에도 많은 프로토콜들이 더 많은 정보를 요구합니다. URL을 사용하는 애플리케이션이 리소스에 접근하려면 프로토콜 파라미터가 필요하게 됩니다. 프로토콜 파라미터가 없으면, 서버는 그 요청을 잘못 처리하거나 처리하지 않을 수 있습니다. FTP의 경우 총 2개 (바이너리와 텍스트) 포맷을 지원하는데, 사용자는 바이너리 이미지가 텍스트 형식으로 전송되는 것을 원하지 않을 것입니다. URL 파라미터 컴포넌트는 서버에 정확한 요청을 하기 위해 필요한 입력값을 받는데 활용됩니다. 이 컴포넌트는 이름/값 쌍의 리스트로 URL 나머지 부분들로 부터 `;` 문자로 구분하여 URL에 기술합니다.

`ftp://prep.ai.mit.edu/pub/gnu;type=d`

이 경우 이름은 type이고 값은 d인 한쌍의 파라미터를 전달합니다. 앞서 말햇듯, HTTP URL에서 경로 컴포넌트는 경로 조각으로 나뉘고 각각의 조각은 자체 파라미터를 가질 수 있습니다. 예를 들어,

http://www.joes-hardware.com/hammers;sale=false/index.html;graphics=true

위 URL의 경우 hammers와 index.html 두개의 경로 조각이 있고 hammers 경로조각은 false 값을 가지는 sale 파라미터를 가지고 index.html 경로조각은 true 값을 가지는 graphics 파라미터를 가지게 됩니다.

### 2-2-6. 질의 문자열

데이터 베이스 같은 프로그램들은 요청받을 리소스 형식 범위를 좁히기 위해 질문이나 질의를 받을 수 있습니다. 조의 컴퓨터 가게에서 상품 재고 리스트가 있고 이를 조회할 수 있다고 가정해 봅시다.

http://www.joes-hardware.com/inventory-check.cgi?item=12731

? 우측에 주목해봅시다. 이를 질의 컴포넌트라고 합니다. URL의 질의 컴포넌트는 게이트 웨이를 가리키는 URL의 경로 컴포넌트와 함께 전달되고 있습니다. 보통 게이트웨이는 다른 애플리케이션에 접근할 때 거치는 통로입니다. 편의상 많은 게이트웨이가 '&'로 나뉜 '이름=값' 쌍 형식의 질의 문자열을 원합니다.

http://www.joes-hardware.com/inventory-check.cgi?item=12731&color=blue

위 예시에는 두개의 질의 컴포넌트가 존재합니다. `item=12731`, `color=blue`.

### 2-2-7. 프래그먼트

HTML 같은 리소스 형식들은 더 작게 나뉘어질 수 있습니다. 예를 들어 절이 포함된 큰 텍스트 문자의 경우, 그 리소스에 대한 URL은 텍스트 전체를 의미하지만, 이상적으로는 리소스 안에 있는 특정 절을 가리키는 것이 편한 상황이 존재합니다. 프래그먼트는 URL 오른쪽에 # 문자에 이어서 옵니다.

http://www.joes-hardware.com/tools.html#drills

여기서 drills라는 프래그먼트는 /tools.html 웹 페이지의 일부를 나타냅니다. 일반적으로 HTTP 서버는 객체 일부가 아닌 전체만을 다루기에, 클라이언트는 서버에 프래그먼트를 전달하지 않습니다. 브라우저가 서버로부터 전체 리소스를 내려받은 후, 프래그먼트를 사용하여 보고자하는 리소스의 일부를 보여줍니다.

### 2-3. 단축 URL

웹 클라이언트는 몇몇 단축 URL을 사용합니다. 상대 URL은 리소스 안에 있는 리소스를 간결하게 기술하는데 활용됩니다. 많은 브라우저가 사용자가 일부 URL만 입력하면 나머지 부분을 자동으로 입력해주는 URL '자동확장'을 지원합니다.

### 2-3-1. 상대 URL

URL은 상대 URL과 절대 URL로 나누어집니다. 절대 URL은 리소스에 접근하는데 필요한 모든 정보를 가지고 있습니다. 그와 달리 상대 URL은 일부 정보만을 가지고 있습니다. 상대 URL로 리소스 접근에 필요한 모든 정보를 얻으려면, 기저(base)라고 하는 다른 URL을 사용해야 합니다. 상대 URL은 URL을 짧게 표기하는 방식입니다. 

```html
<html>
    <head>
        <title>Joe's Tools</title>
    </head>
    <body>
       <h1>
           Tools Page
       </h1>
       <a href="./hammers.html">Hammers</a>
    </body>
</html>
```

위 HTML 문서에서는 `./hammers.html` 을 가리키는 하이퍼링크가 존재합니다. 이 URL은 미완성인 것처럼 보이나, 올바른 상대 URL입니다. 상대 URL에 따르면, HTML 작성자는 URL에 스킴과 호스트 그리고 다른 컴포넌트들을 모두 입력하지 않아도 됩니다. 그 정보는 컴포넌트가 포함된 리서스의 기저 URL에서 알아낼 수 있습니다. 위의 html 문서의 경우 기저 URL은 `http://www.joes-hardware.com/tools.html`입니다. 이 URL을 기저 URL로 사용하여, 상대 URL에서는 기술하지 않은 정보를 추측할 수 있습니다. 필요한 리소스가  `./hammers.html`이고 기저 URL을 활용하면 스킴은 http이고 호스트는 www.joes-hardware.com이란 것을 추측할 수 있습니다.

상대 URL은 프래그먼트이거나 URL의 일부입니다. URL을 처리하는 브라우저 같은 프로그램은 상대 URL과 절대 URL간에 상호 변환이 가능해야 합니다. 상대 URL을 사용하면 리소스 집합을 쉽게 변경할 수 있습니다.

**기저 URL**

변환 과정의 첫 단계는 기저 URL을 찾는 것입니다. 기저 URL은 상대 URL의 기준이 됩니다.

**리소스에서 명시적으로 제공**

어떤 리소스들은 기저 URL을 명확하게 기술하기도 합니다. 그 예로, HTML 문서에서는 그 안에 있는 모든 상대 URL을 변경하기 위해 기저 URL을 가리키는 <base> 태그를 기술할 수 있습니다.

**리소스를 포함하고 있는 기저 URL**

만약 상대 URL이 기저 URL이 명시되지 않은 리소스에 포함되어 있을 경우, 해당 리소스의 URL을 기저 URL로 쓸 수 있습니다.

**기저 URL이 없는 경우**

이런 경우에는 절대 URL만으로 이루어졌다는 뜻입니다. 하지만 불완전하고 깨진 URL일 가능성이 높습니다.